ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line(aes(color=avg)) +
geom_point() +
theme_minimal()
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal()
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none", y.label = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none", y.lab = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(x = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
scale_fill_gradient(low = "red", high = "green") +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
scale_fill_brewer(palette = "RdYlGn") +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size = 0.8) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size = 0.8) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size = 0.8) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(fill=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(fill=method),size = 0.8) +
geom_point(aes(fill=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
color
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "Average Sentiment Score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size = 0.8) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.5) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.65) +
geom_point(aes(color=method),alpha=0.2) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.65) +
geom_point(aes(color=method),alpha=0.1) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "average Sentiment score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "ASCENDAS REAL ESTATE INV TRUST") %>%
filter(Year == 2021) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.65) +
geom_point(aes(color=method),alpha=0.1) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "CITY DEVELOPMENTS LIMITED") %>%
filter(Year == 2015) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.65) +
geom_point(aes(color=method),alpha=0.1) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "CITY DEVELOPMENTS LIMITED") %>%
filter(Year == 2015) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "average Sentiment score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments %>%
pivot_longer(!c("Company","Year","page"),names_to="method",values_to="sentiment") %>%
filter(Company == "KEPPEL CORPORATION LIMITED") %>%
filter(Year == 2015) %>%
ggplot(aes(x=page,y=sentiment,group=method)) +
geom_line(aes(color=method),size=0.65) +
geom_point(aes(color=method),alpha=0.1) +
theme_minimal() +
theme(legend.position="bottom") +
scale_fill_brewer(palette = "Pastel1")
sentiments %>%
mutate(
avg = (afinn+bing+jockers+loughran+nrc)/5,
max = pmax(afinn,bing,jockers,loughran,nrc),
min = pmin(afinn,bing,jockers,loughran,nrc)
) %>%
filter(Company == "KEPPEL CORPORATION LIMITED") %>%
filter(Year == 2015) %>%
ggplot(aes(x=page,y=avg)) +
geom_errorbar(aes(ymin=min,ymax=max),width=0.5,alpha=0.3, position=position_dodge(0.05)) +
geom_line() +
geom_point(aes(color=avg)) +
theme_minimal() +
theme(legend.position="none") +
labs(y = "average Sentiment score") +
scale_fill_brewer(palette = "RdYlGn")
sentiments_with_average <- sentiments %>%
mutate(
average_sentiment = (afinn+bing+jockers+loughran+nrc)/5
)
setwd("C:/Users/Jeremy Chia/Desktop/2022/Research/Code/4. Sentiment Analysis")
write.csv(sentiments_with_average, "sentiments.csv", row.names = F)
# Processing Text of Sustainability Reports
library(pdftools)
library(dplyr)
library(tidytext)
library(tm)
library(textstem)
library(topicmodels)
library(lda)
library(ldatuning)
library(ggplot2)
library(wordcloud)
library(pals)
library(SnowballC)
library(stringr)
# Initiating work directory
setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/")
# Defining variables
reports <- read.csv("sustainability_reports_sgx_sti.csv")
setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/Sustainability Reports or Annual Reports")
# Reading in Text
for (i in 1:nrow(reports)){
if (i == 1){
text <- pdftools::pdf_text(reports$DocumentName[i])
# Initiate the first dataframe
text_df <- tibble(page = 1:length(text), text = text)
text_df$Company <- reports$Company[i]
text_df$Year <- reports$Year[i]
}
else{
text <- pdftools::pdf_text(reports$DocumentName[i])
# Create a temporary dataframe
text_df_temp <- tibble(page = 1:length(text), text = text)
text_df_temp$Company <- reports$Company[i]
text_df_temp$Year <- reports$Year[i]
# Append to the original dataframe
text_df <- rbind(text_df,text_df_temp)
}
}
# Summarising Results
number_pages <- text_df %>%
group_by(Company, Year) %>%
count()
number_pages %>%
mutate(
Year = as.character(Year)
) %>%
ggplot(aes(x=Year,y=n)) +
geom_boxplot(aes(x=Year), fill = "grey", alpha = 0.2) +
geom_jitter(width = 0.1, alpha = 0.5) +
theme_minimal() +
ggtitle("Number of Pages by Year") +
ylab("Number of Pages") +
xlab("Disclosure for Year Ended In")
theme(legend.position="none") +
scale_fill_brewer(palette="Blues")
setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/")
write.csv(number_pages, "number_of_pages.csv", row.names=F)
# Converting to a Corpus
docs <- Corpus(VectorSource(text_df$text))
# Text Cleaning
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "\n")
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
# docs <- tm_map(docs, toSpace, "*")
docs <- tm_map(docs, toSpace, "[^[:alnum:] ]")
# setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/")
# characters_remove <- read.csv("characters.csv")
#
# for (i in 1:nrow(characters_remove)){
#   docs <- tm_map(docs, toSpace, characters_remove$X.[i])
#   print(i)
# }
# Text Cleaning
# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("english"))
# Remove english (SMART) common stopwords
docs <- tm_map(docs, removeWords, stopwords("SMART"))
# Remove your own stop word
# specify your stopwords as a character vector
docs <- tm_map(docs, removeWords, c("reporting","period","report","fy")) # reporting words
## Remove additional stopwords as identified
setwd("C:/Users/Jeremy Chia/Desktop/2022/Research/Code/1. Before removing additional stopwords")
to_remove <- as.vector(read.csv("2. to_remove.csv",header=T)[[1]])
docs <- tm_map(docs, removeWords, to_remove) # remove company, country, irrelevant words
# Remove punctuations
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)
# Text lemmization
docs <- lemmatize_words(docs, dictionary = lexicon::hash_lemmas)
#####
# Compute Document Term Matrix where Word >= minimumFrequency
minimumFrequency <- 10
DTM <- DocumentTermMatrix(docs, control = list(bounds = list(global = c(minimumFrequency, Inf))))
DTM <- DTM[apply(DTM,1,FUN=sum)!=0,]
docs
# Processing Text of Sustainability Reports
library(pdftools)
library(dplyr)
library(tidytext)
library(tm)
library(textstem)
library(topicmodels)
library(lda)
library(ldatuning)
library(ggplot2)
library(wordcloud)
library(pals)
library(SnowballC)
library(stringr)
# Initiating work directory
setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/")
# Defining variables
reports <- read.csv("sustainability_reports_sgx_sti.csv")
setwd("C:/Users/Jeremy Chia/Documents/GitHub/NLP-SustainabilityReports-FinancialPerformance/Sustainability Reports or Annual Reports")
# Reading in Text
for (i in 1:nrow(reports)){
if (i == 1){
text <- pdftools::pdf_text(reports$DocumentName[i])
text_joined <- paste(text, collapse = ' ')
# Initiate the first dataframe
text_df <- tibble(text = text_joined)
text_df$Company <- reports$Company[i]
text_df$Year <- reports$Year[i]
}
else{
text <- pdftools::pdf_text(reports$DocumentName[i])
text_joined <- paste(text, collapse = ' ')
# Create a temporary dataframe
text_df_temp <- tibble(text = text_joined)
text_df_temp$Company <- reports$Company[i]
text_df_temp$Year <- reports$Year[i]
# Append to the original dataframe
text_df <- rbind(text_df,text_df_temp)
}
}
# Converting to a Corpus
docs <- Corpus(VectorSource(text_df$text))
# Text Cleaning
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "\n")
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
# docs <- tm_map(docs, toSpace, "*")
docs <- tm_map(docs, toSpace, "[^[:alnum:] ]")
# Text Cleaning
# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("english"))
# Remove english (SMART) common stopwords
docs <- tm_map(docs, removeWords, stopwords("SMART"))
# Remove your own stop word
# specify your stopwords as a character vector
docs <- tm_map(docs, removeWords, c("reporting","period","report","fy")) # reporting words
## Remove additional stopwords as identified
setwd("C:/Users/Jeremy Chia/Desktop/2022/Research/Code/1. Before removing additional stopwords")
to_remove <- as.vector(read.csv("2. to_remove.csv",header=T)[[1]])
docs <- tm_map(docs, removeWords, to_remove) # remove company, country, irrelevant words
# Remove punctuations
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)
# Text lemmization
docs <- lemmatize_words(docs, dictionary = lexicon::hash_lemmas)
# Compute Document Term Matrix where Word >= minimumFrequency
minimumFrequency <- 10
DTM <- DocumentTermMatrix(docs, control = list(bounds = list(global = c(minimumFrequency, Inf))))
DTM <- DTM[apply(DTM,1,FUN=sum)!=0,]
